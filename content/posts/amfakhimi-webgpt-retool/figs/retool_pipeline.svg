<svg xmlns="http://www.w3.org/2000/svg" width="1500" height="900">

<defs>
  <marker id="arrow" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
    <polygon points="0 0, 10 3.5, 0 7" />
  </marker>
  <style>
    .box { fill: #ffffff; stroke: #000000; stroke-width: 2; rx: 12; ry: 12; }
    .lbl { font-family: 'DejaVu Sans', Arial, sans-serif; font-size: 28px; }
    .small { font-size: 20px; }
    .mono { font-family: 'DejaVu Sans Mono', monospace; font-size: 20px; }
    .title { font-size: 36px; font-weight: bold; }
    .arrow { stroke: #000000; stroke-width: 2; fill: none; marker-end: url(#arrow); }
    .caption { font-size: 18px; font-style: italic; }
  </style>
</defs>

<text x="750" y="60" text-anchor="middle" class="title">ReTool: Interleaved Reasoning + Code &amp; RL (schematic)</text>

<!-- Top: Inference rollout -->
<rect class="box" x="60" y="120" width="260" height="90"/>
<text x="190" y="175" text-anchor="middle" class="lbl">Question</text>

<rect class="box" x="360" y="120" width="280" height="110"/>
<text x="500" y="165" text-anchor="middle" class="lbl">Policy LLM</text>
<text x="500" y="195" text-anchor="middle" class="small">decides to reason or call tool</text>

<rect class="box" x="680" y="120" width="290" height="110"/>
<text x="825" y="160" text-anchor="middle" class="lbl">Reason step</text>
<text x="825" y="195" text-anchor="middle" class="small">(text)</text>

<rect class="box" x="1010" y="120" width="260" height="110"/>
<text x="1140" y="160" text-anchor="middle" class="lbl">Code cell</text>
<text x="1140" y="195" text-anchor="middle" class="small">executes &amp; returns output</text>

<rect class="box" x="1290" y="120" width="170" height="110"/>
<text x="1375" y="165" text-anchor="middle" class="lbl">Answer</text>

<line class="arrow" x1="320" y1="165" x2="360" y2="165"/>
<line class="arrow" x1="640" y1="175" x2="680" y2="175"/>
<line class="arrow" x1="970" y1="175" x2="1010" y2="175"/>
<line class="arrow" x1="1270" y1="175" x2="1290" y2="175"/>

<!-- Feedback / RL -->
<rect class="box" x="420" y="360" width="320" height="120"/>
<text x="580" y="405" text-anchor="middle" class="lbl">Outcome Reward</text>
<text x="580" y="435" text-anchor="middle" class="small">task success / score</text>

<rect class="box" x="800" y="360" width="320" height="120"/>
<text x="960" y="405" text-anchor="middle" class="lbl">Policy Update (RL)</text>
<text x="960" y="435" text-anchor="middle" class="small">learns when/how to run code</text>

<line class="arrow" x1="1375" y1="230" x2="580" y2="360"/>
<line class="arrow" x1="740" y1="420" x2="800" y2="420"/>
<line class="arrow" x1="960" y1="360" x2="500" y2="230"/>

<!-- SFT Warm-start -->
<rect class="box" x="100" y="600" width="400" height="120"/>
<text x="300" y="640" text-anchor="middle" class="lbl">Synthetic code-aug traces</text>
<text x="300" y="675" text-anchor="middle" class="small">(SFT warm-start)</text>

<rect class="box" x="560" y="600" width="320" height="120"/>
<text x="720" y="660" text-anchor="middle" class="lbl">Supervised Fine-tuning</text>

<line class="arrow" x1="500" y1="660" x2="560" y2="660"/>
<line class="arrow" x1="720" y1="600" x2="500" y2="230"/>

<text x="750" y="850" text-anchor="middle" class="caption">Note: diagram is illustrative; not to scale.</text>
</svg>